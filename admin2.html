<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>管理者用：データ作成ツール</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .admin-box { background: #fff; border: 1px solid #000; padding: 20px; max-width: 900px; margin: 20px auto; }
        textarea { width: 100%; height: 100px; margin: 10px 0; font-family: monospace; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        input { width: 90%; padding: 5px; border: none; }
        .btn-row { margin: 20px 0; display: flex; gap: 10px; }
        button { cursor: pointer; padding: 10px 20px; background: #000; color: #fff; border: none; }
        #output { background: #333; color: #fff; padding: 15px; white-space: pre-wrap; display: none; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="home-wrapper">
        <h1>歌詞データ エディタ</h1>
        
        <div class="admin-box">
            <h3>1. 歌詞を貼り付け (形式: 00:00 歌詞)</h3>
            <textarea id="rawInput" placeholder="00:18 握りしめた手が何か言う"></textarea>
            <button onclick="importText()">表に反映する</button>

            <table id="dataTable">
                <thead>
                    <tr>
                        <th style="width: 15%;">時間</th>
                        <th style="width: 45%;">歌詞</th>
                        <th style="width: 30%;">メモ (赤字で表示)</th>
                        <th style="width: 10%;">削除</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>

            <div class="btn-row">
                <button onclick="addRow()">＋ 行を追加</button>
                <button onclick="generateCode()" style="background: #a40000;">コードを生成する</button>
            </div>

            <div id="output"></div>
        </div>
        <a href="index.html" class="back-link">← 戻る</a>
    </div>

    <script>
        function addRow(time = "", text = "", memo = "") {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td><input type="text" class="t-time" value="${time}" placeholder="00:00"></td>
                <td><input type="text" class="t-text" value="${text}"></td>
                <td><input type="text" class="t-memo" value="${memo}"></td>
                <td><button onclick="this.parentElement.parentElement.remove()">×</button></td>
            `;
            document.getElementById('tableBody').appendChild(tr);
        }

        function importText() {
            const input = document.getElementById('rawInput').value.trim();
            if (!input) return;
            const lines = input.split('\n');
            lines.forEach(line => {
                const match = line.match(/(\d{2}:\d{2})\s+(.*)/);
                if (match) addRow(match[1], match[2], "");
            });
            document.getElementById('rawInput').value = "";
        }

        function generateCode() {
            const rows = document.querySelectorAll('#tableBody tr');
            let code = "const myData = [\n";
            rows.forEach(row => {
                const time = row.querySelector('.t-time').value;
                const text = row.querySelector('.t-text').value;
                const memo = row.querySelector('.t-memo').value;
                code += `    ["${time}", "${text}", "${memo}"],\n`;
            });
            code += "];";
            
            const out = document.getElementById('output');
            out.textContent = code;
            out.style.display = "block";
            alert("コードを生成しました。一番下の黒い枠からコピーしてHTMLのmyData部分に貼り付けてください。");
        }
    </script>
</body>
</html>
