<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>データエディタ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="page-wrapper">
        <h1>歌詞データ エディタ</h1>
        <div class="admin-box">
            <h3>1. 歌詞を貼り付け (00:00 歌詞)</h3>
            <textarea id="rawInput"></textarea>
            <button class="btn" onclick="importText()">表に反映する</button>

            <table class="admin-table">
                <thead>
                    <tr><th>時間</th><th>歌詞</th><th>メモ</th><th>削除</th></tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>

            <div style="margin-top:20px; display:flex; gap:10px;">
                <button class="btn" onclick="addRow()">＋ 行を追加</button>
                <button class="btn btn-red" onclick="generateCode()">コードを生成</button>
            </div>
            <div id="output"></div>
        </div>
        <a href="index.html" class="btn back-link">← 戻る</a>
    </div>

    <script>
        function addRow(time = "", text = "", memo = "") {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td><input type="text" class="t-time" value="${time}" placeholder="00:00"></td>
                <td><input type="text" class="t-text" value="${text}"></td>
                <td><input type="text" class="t-memo" value="${memo}"></td>
                <td><button onclick="this.parentElement.parentElement.remove()">×</button></td>
            `;
            document.getElementById('tableBody').appendChild(tr);
        }

        function importText() {
            const input = document.getElementById('rawInput').value.trim();
            const lines = input.split('\n');
            lines.forEach(line => {
                const match = line.match(/(\d{1,2}:\d{2})\s+(.*)/);
                if (match) addRow(match[1], match[2], "");
            });
            document.getElementById('rawInput').value = "";
        }

        function generateCode() {
            const rows = document.querySelectorAll('#tableBody tr');
            let code = "const myData = [\n";
            rows.forEach(row => {
                const time = row.querySelector('.t-time').value;
                const text = row.querySelector('.t-text').value;
                const memo = row.querySelector('.t-memo').value;
                code += `  ["${time}", "${text}", "${memo}"],\n`;
            });
            code += "];";
            const out = document.getElementById('output');
            out.textContent = code;
            out.style.display = "block";
            alert("コードを生成しました！");
        }
    </script>
</body>
</html>
